//Generated by wsdl2apex

public class TibcoBillHistory_Service {
    public class getBillHistory_xConsumer {
        //public String endpoint_x = 'http://www.postbin.org/wrvryh';
        public String endpoint_x = SystemSettings__c.getInstance().Tibco_Host_URL__c + '/BillHistory/ServiceAdapter/getBillHistory_Consumer';
        public Map<String,String> inputHttpHeaders_x;
        public Map<String,String> outputHttpHeaders_x;
        public String clientCertName_x;
        public String clientCert_x;
        public String clientCertPasswd_x;
        public Integer timeout_x;
        private String[] ns_map_type_info = new String[]{'http://www.sewl.com.au/esb/wsdl/salesforce/billhistory/getBillHistoryImpl/BillHistory/ServiceAdapter', 'TibcoBillHistory_Service', 'http://www.sewl.com.au/esb/schemas/salesforce/billhistory', 'TibcoBillHistory_MessageTypes'};
        public TibcoBillHistory_MessageTypes.getBillHistoryResponse_element getBillHistory(String AccountNumber,TibcoBillHistory_MessageTypes.Header_element Header) {
            TibcoBillHistory_MessageTypes.getBillHistoryRequest_element request_x = new TibcoBillHistory_MessageTypes.getBillHistoryRequest_element();
            TibcoBillHistory_MessageTypes.getBillHistoryResponse_element response_x;
            request_x.AccountNumber = AccountNumber;
            request_x.Header = Header;
            Map<String, TibcoBillHistory_MessageTypes.getBillHistoryResponse_element> response_map_x = new Map<String, TibcoBillHistory_MessageTypes.getBillHistoryResponse_element>();
            response_map_x.put('response_x', response_x);
            if(!Test.isRunningTest()&&!SystemSettings__c.getInstance().Disable_Web_Services__c){            
                WebServiceCallout.invoke(
                  this,
                  request_x,
                  response_map_x,
                  new String[]{endpoint_x,
                  'getBillhistory',
                  'http://www.sewl.com.au/esb/schemas/salesforce/billhistory',
                  'getBillHistoryRequest',
                  'http://www.sewl.com.au/esb/schemas/salesforce/billhistory',
                  'getBillHistoryResponse',
                  'TibcoBillHistory_MessageTypes.getBillHistoryResponse_element'}
                );
                response_x = response_map_x.get('response_x');
            } else {
                response_x = new TibcoBillHistory_MessageTypes.getBillHistoryResponse_element();
                
                if (!SystemSettings__c.getInstance().Disable_Web_Services__c) {
                    response_x.Header = new TibcoBillHistory_MessageTypes.Header_element();
                    response_x.Header.MessageResponseStatus = new TibcoBillHistory_MessageTypes.MessageResponseStatus_element();
                    response_x.Header.MessageResponseStatus.MessageSuccessInd = 'true';
                    response_x.ProcessOutputData = new TibcoBillHistory_MessageTypes.ProcessOutputData_element();
                    response_x.ProcessOutputData.Bills = new TibcoBillHistory_MessageTypes.Bills_element();
                    response_x.ProcessOutputData.Bills.Bill = new List<TibcoBillHistory_MessageTypes.Bill_element>();
                    /* Create 10 rows of Test Data */
                    for(Integer i = 0; i < 10; i++) {
	                     /* Add Bill */
	                     TibcoBillHistory_MessageTypes.Bill_element b = new TibcoBillHistory_MessageTypes.Bill_element();
	                        b.BillNumber = i.format();
	                        b.Reason = 'Normal Bill';
	                        b.BilledDate = Date.today();
	                        b.PrintedDate = Date.today();
	                        b.BroughtForwardAmount = '0.00';
	                        b.BilledAmount = '100.00';
	                        b.BillTotal = '100.00';
	                    response_x.ProcessOutputData.Bills.Bill.add(b);
	                    
	                    /* Add Bill Line */    
	                    response_x.ProcessOutputData.Bills.Bill[i].BillLineDetails = new List<TibcoBillHistory_MessageTypes.BillLineDetails_element>();                 
	                    TibcoBillHistory_MessageTypes.BillLineDetails_element bLine = new TibcoBillHistory_MessageTypes.BillLineDetails_element();                  
	                        bLine.TariffDescription = 'WATER USAGE RESIDEN';
	                        bLine.Basis = '';
	                        bLine.UnitCost = '100.00';
	                        bLine.LineNet = '100.00';
	                        bLine.LineVAT = '0.00';
	                        bLine.LineTotal = '100.00';
	                        bLine.PeriodFrom = Date.today();
	                        bLine.PeriodTo = Date.today();                                                          
	                    
	                    response_x.ProcessOutputData.Bills.Bill[0].BillLineDetails.add(bLine);               	
                    }
                    
                    
                } else { // return failure
                    response_x.Header = new TibcoBillHistory_MessageTypes.Header_element();
                    response_x.Header.MessageResponseStatus = new TibcoBillHistory_MessageTypes.MessageResponseStatus_element();
                    response_x.Header.MessageResponseStatus.MessageSuccessInd = 'false';                    
                    response_x.Header.MessageResponseStatus.ErrorStatus = new List<TibcoBillHistory_MessageTypes.ErrorStatus_element>();                    
                    TibcoBillHistory_MessageTypes.ErrorStatus_element err = new TibcoBillHistory_MessageTypes.ErrorStatus_element();
                    err.ErrorCode='123';
                    err.ErrorSeverity='High';
                    err.ErrorDescription='Test Error';
                    response_x.Header.MessageResponseStatus.ErrorStatus.add(err);                   
                }                           
            }
                
            return response_x;
        }
    }
}